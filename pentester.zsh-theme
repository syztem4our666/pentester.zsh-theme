# ~/.oh-my-zsh/themes/pentester.zsh-theme

function get_vpn_ip {
  local vpn_ip=$(ip -4 addr show dev tun0 2>/dev/null | grep inet | awk '{print $2}' | cut -d/ -f1)
  echo ${vpn_ip:-"N/A"}
}

function get_active_ip {
  local active_ip=$(ip -4 addr show dev wlan0 2>/dev/null | grep inet | awk '{print $2}' | cut -d/ -f1)
  if [ -z "$active_ip" ]; then
    active_ip=$(ip -4 addr show dev eth0 2>/dev/null | grep inet | awk '{print $2}' | cut -d/ -f1)
  fi
  echo ${active_ip:-"No IP"}
}

function get_target_ip {
  if [ -n "$TARGET_IP" ]; then
    echo "$TARGET_IP"
  elif [ -f ~/.target_ip ]; then
    cat ~/.target_ip
  else
    echo "No target set"
  fi
}

function get_ip_to_show {
  local vpn_ip=$(get_vpn_ip)
  if [ "$vpn_ip" != "N/A" ]; then
    echo "VPN:$vpn_ip"
  else
    echo "IP:$(get_active_ip)"
  fi
}
PROMPT='[%F{green}%n@%F{reset}] [%F{red}%~%F{reset}] [%F{cyan}$(get_ip_to_show)%F{reset}] [%F{blue}Target:$(get_target_ip)%F{reset}]: % '

